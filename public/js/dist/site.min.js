/*! site 2017-08-29 */
var gb=gb||{};gb.Namespace=function(a,b){var c,d,e=b.split("."),f=a;for("gb"===e[0]&&(e=e.slice(1)),c=e.length,d=0;d<c;d++)"undefined"==typeof f[e[d]]&&(f[e[d]]={}),f=f[e[d]];return f},gb.Class=function(a){"use strict";var b=function(){this.init.apply(this,arguments)};if(a){var c=function(){};c.prototype=a.prototype,b.prototype=new c}return b.prototype.init=function(){},b.fn=b.prototype,b.fn.parent=b,b.extend=function(a){var c=a.extended;for(var d in a)b[d]=a[d];c&&c(b)},b.include=function(a){var c=a.included;for(var d in a)b.fn[d]=a[d];c&&c(b)},b},this.JST=this.JST||{},Handlebars.registerPartial("gridCell",Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<td id="grid-'+a.escapeExpression((f=null!=(f=c.cellName||(null!=b?b.cellName:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"cellName",hash:{},data:e}):f))+'">&nbsp;</td>'},useData:!0})),Handlebars.registerPartial("gridHeaders",Handlebars.template({1:function(a,b,c,d,e){var f=a.lambda,g=a.escapeExpression;return'        <td class="head-'+g(f(b,b))+'">'+g(f(b,b))+"</td>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return"<thead>\n<tr>\n    <td></td>\n"+(null!=(f=c.each.call(null!=b?b:{},null!=b?b.gridHeaders:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"</tr>\n</thead>"},useData:!0})),Handlebars.registerPartial("gridRows",Handlebars.template({1:function(a,b,c,d,e){var f,g,h=null!=b?b:{};return"  <tr>\n  <td>"+a.escapeExpression((g=null!=(g=c.rowName||(null!=b?b.rowName:b))?g:c.helperMissing,"function"==typeof g?g.call(h,{name:"rowName",hash:{},data:e}):g))+"</td>\n"+(null!=(f=c.each.call(h,null!=b?b.gridCells:b,{name:"each",hash:{},fn:a.program(2,e,0),inverse:a.noop,data:e}))?f:"")+"  </tr>\n"},2:function(a,b,c,d,e){var f;return null!=(f=a.invokePartial(d.gridCell,b,{name:"gridCell",data:e,indent:"      ",helpers:c,partials:d,decorators:a.decorators}))?f:""},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return null!=(f=c.each.call(null!=b?b:{},null!=b?b.gridRows:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:""},usePartial:!0,useData:!0})),this.JST["handlebars/gridGroups.hbs"]=Handlebars.template({1:function(a,b,c,d,e){var f,g;return"  <h2>"+a.escapeExpression((g=null!=(g=c.groupName||(null!=b?b.groupName:b))?g:c.helperMissing,"function"==typeof g?g.call(null!=b?b:{},{name:"groupName",hash:{},data:e}):g))+'</h2>\n  <table class="table">\n'+(null!=(f=a.invokePartial(d.gridHeaders,b,{name:"gridHeaders",data:e,indent:"    ",helpers:c,partials:d,decorators:a.decorators}))?f:"")+(null!=(f=a.invokePartial(d.gridRows,b,{name:"gridRows",data:e,indent:"    ",helpers:c,partials:d,decorators:a.decorators}))?f:"")+"  </table>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return null!=(f=c.each.call(null!=b?b:{},null!=b?b.gridList:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:""},usePartial:!0,useData:!0}),this.JST["handlebars/message.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=null!=b?b:{},h=c.helperMissing,i="function",j=a.escapeExpression;return'<div class="message-header">\n    <span class="glyphicon glyphicon-time"></span>\n    <span>'+j((f=null!=(f=c.ts||(null!=b?b.ts:b))?f:h,typeof f===i?f.call(g,{name:"ts",hash:{},data:e}):f))+'</span>\n    <span class="glyphicon glyphicon-user"></span>\n    <strong>'+j((f=null!=(f=c.username||(null!=b?b.username:b))?f:h,typeof f===i?f.call(g,{name:"username",hash:{},data:e}):f))+':</strong>\n    <div class="message">'+j((f=null!=(f=c.message||(null!=b?b.message:b))?f:h,typeof f===i?f.call(g,{name:"message",hash:{},data:e}):f))+"</div>\n</div>\n"},useData:!0}),this.JST["handlebars/streamInstagram.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression,l=a.lambda;return'<div class="media">\n    <a href="'+k((g=null!=(g=c.url||(null!=b?b.url:b))?g:i,typeof g===j?g.call(h,{name:"url",hash:{},data:e}):g))+'" target="_blank" class="hidden-xs">\n        <img src="//cdn.suayan.com/dist/img/ks-logo.svg" data-src="'+k(l(null!=(f=null!=(f=null!=b?b.pictures:b)?f.low_resolution:f)?f.url:f,b))+'" class="instagram lazy"/>\n    </a>\n    <a href="'+k((g=null!=(g=c.url||(null!=b?b.url:b))?g:i,typeof g===j?g.call(h,{name:"url",hash:{},data:e}):g))+'" target="_blank" class="visible-xs">\n        <img src="//cdn.suayan.com/dist/img/ks-logo.svg" data-src="'+k(l(null!=(f=null!=(f=null!=b?b.pictures:b)?f.standard_resolution:f)?f.url:f,b))+'" class="instagram lazy"/>\n    </a>\n    <div class="caption">\n        <span class="label label-primary">Instagram</span>\n        <span class="when">'+k((g=null!=(g=c.ago||(null!=b?b.ago:b))?g:i,typeof g===j?g.call(h,{name:"ago",hash:{},data:e}):g))+"</span>\n        <h2>"+k((g=null!=(g=c.body||(null!=b?b.body:b))?g:i,typeof g===j?g.call(h,{name:"body",hash:{},data:e}):g))+"</h2>\n    </div>\n</div>"},useData:!0}),this.JST["handlebars/streamTwitter.hbs"]=Handlebars.template({1:function(a,b,c,d,e){var f,g=null!=b?b:{},h=c.helperMissing,i="function",j=a.escapeExpression;return'<a href="'+j((f=null!=(f=c.permalink||(null!=b?b.permalink:b))?f:h,typeof f===i?f.call(g,{name:"permalink",hash:{},data:e}):f))+'" class="permalink" target="_blank">'+j((f=null!=(f=c.permalink||(null!=b?b.permalink:b))?f:h,typeof f===i?f.call(g,{name:"permalink",hash:{},data:e}):f))+"</a>"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<div class="media">\n    <div class="caption twitter">\n        <span class="label label-primary">Twitter</span>\n        <span class="when">'+k((g=null!=(g=c.ago||(null!=b?b.ago:b))?g:i,typeof g===j?g.call(h,{name:"ago",hash:{},data:e}):g))+'</span>\n        <a href="http://twitter.com/'+k((g=null!=(g=c.user||(null!=b?b.user:b))?g:i,typeof g===j?g.call(h,{name:"user",hash:{},data:e}):g))+'" class="handle">@'+k((g=null!=(g=c.user||(null!=b?b.user:b))?g:i,typeof g===j?g.call(h,{name:"user",hash:{},data:e}):g))+"</a>\n        <h2>"+k((g=null!=(g=c.body||(null!=b?b.body:b))?g:i,typeof g===j?g.call(h,{name:"body",hash:{},data:e}):g))+"</h2>\n        "+(null!=(f=c.if.call(h,null!=b?b.permalink:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"\n    </div>\n</div>"},useData:!0}),this.JST["handlebars/streamVimeo.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function";return'<div class="media">\n    <div class="caption">\n        <div class="vimeo">'+(null!=(g=null!=(g=c.body||(null!=b?b.body:b))?g:i,f=typeof g===j?g.call(h,{name:"body",hash:{},data:e}):g)?f:"")+'</div>\n        <span class="label label-primary">Vimeo</span>\n        <span class="when">'+a.escapeExpression((g=null!=(g=c.ago||(null!=b?b.ago:b))?g:i,typeof g===j?g.call(h,{name:"ago",hash:{},data:e}):g))+"</span>\n    </div>\n</div>\n"},useData:!0}),this.JST["handlebars/systemMessage.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<div class="message">'+a.escapeExpression((f=null!=(f=c.message||(null!=b?b.message:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"message",hash:{},data:e}):f))+"</div>\n"},useData:!0}),this.JST["handlebars/tile.hbs"]=Handlebars.template({1:function(a,b,c,d,e){var f;return"<p>"+(null!=(f=a.lambda(b,b))?f:"")+"</p>\n"},3:function(a,b,c,d,e){return'  <span class="label label-primary">'+a.escapeExpression(a.lambda(b,b))+"</span>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return"<h2>"+k((g=null!=(g=c.pageTitle||(null!=b?b.pageTitle:b))?g:i,typeof g===j?g.call(h,{name:"pageTitle",hash:{},data:e}):g))+"</h2>\n<h3>"+k((g=null!=(g=c.subhead||(null!=b?b.subhead:b))?g:i,typeof g===j?g.call(h,{name:"subhead",hash:{},data:e}):g))+'</h3>\n<p class="description">'+k((g=null!=(g=c.description||(null!=b?b.description:b))?g:i,typeof g===j?g.call(h,{name:"description",hash:{},data:e}):g))+"</p>\n"+(null!=(f=c.each.call(h,null!=b?b.body:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'\n<div class="indent">\n  <span class="label">Tech:</span>\n'+(null!=(f=c.each.call(h,null!=b?b.tech:b,{name:"each",hash:{},fn:a.program(3,e,0),inverse:a.noop,data:e}))?f:"")+"</div>\n"},useData:!0}),this.JST["handlebars/user-label.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=null!=b?b:{},h=c.helperMissing,i="function",j=a.escapeExpression;return'<span class="label '+j((f=null!=(f=c.labelType||(null!=b?b.labelType:b))?f:h,typeof f===i?f.call(g,{name:"labelType",hash:{},data:e}):f))+'">'+j((f=null!=(f=c.username||(null!=b?b.username:b))?f:h,typeof f===i?f.call(g,{name:"username",hash:{},data:e}):f))+"</span>\n"},useData:!0}),this.JST["handlebars/vimeo.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<div class="media">\n    <div class="media-heading">\n        <h2><a href="'+k((g=null!=(g=c.link||(null!=b?b.link:b))?g:i,typeof g===j?g.call(h,{name:"link",hash:{},data:e}):g))+'">'+k((g=null!=(g=c.name||(null!=b?b.name:b))?g:i,typeof g===j?g.call(h,{name:"name",hash:{},data:e}):g))+"</a>, "+k((g=null!=(g=c.ago||(null!=b?b.ago:b))?g:i,typeof g===j?g.call(h,{name:"ago",hash:{},data:e}):g))+'</h2>\n    </div>\n    <div class="media-body">\n        '+(null!=(f=a.lambda(null!=(f=null!=b?b.embed:b)?f.html:f,b))?f:"")+"\n    </div>\n</div>\n"},useData:!0}),gb.Namespace(gb,"gb.util"),gb.util={randomArray:function(a,b){for(var c=new Array(a),d=0;d<a;d++)c[d]=Math.floor(Math.random()*(b+1));return c},arrayMax:function(a){return Math.max.apply(Math,a)},arrayMin:function(a){return Math.min.apply(Math,a)},rad:function(a){return a*Math.PI/180},getDistance:function(a,b){var c=6378137,d=gb.util.rad(b.lat()-a.lat()),e=gb.util.rad(b.lng()-a.lng()),f=Math.sin(d/2)*Math.sin(d/2)+Math.cos(gb.util.rad(a.lat()))*Math.cos(gb.util.rad(b.lat()))*Math.sin(e/2)*Math.sin(e/2),g=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),h=c*g;return h},zeroFill:function(a,b){return b-=a.toString().length,b>0?new Array(b+(/\./.test(a)?2:1)).join("0")+a:a+""},countSyllables:function(a){return a=a.toLowerCase(),a.length<=3?1:(a=a.replace(/(?:[^laeiouy]es|ed|[^laeiouy]e)$/,""),a=a.replace(/^y/,""),a.match(/[aeiouy]{1,2}/g).length)},countWords:function(a){var b=a.match(/\S+/g)||[];return b.length},countSentences:function(a){var b=a.match(/[\.\?\!]/g)||[];return b.length},fleschReadingEase:function(a){var b=gb.util.countWords(a),c=gb.util.countSentences(a),d=gb.util.countSyllables(a);return console.log("words:",b,"sentences:",c,"syllables:",d),206.835-1.015*(b/c)-84.6*(d/b)},fleschKincaidGradeLevel:function(a){var b=gb.util.countWords(a),c=gb.util.countSentences(a),d=gb.util.countSyllables(a);return console.log("words:",b,"sentences:",c,"syllables:",d),.39*(b/c)+11.8*(d/b)-15.59},getDedupedValuesByKey:function(a,b){var c=[],d={};if(!a.length)return c;for(var e=0,f=a.length;e<f;e++){var g=a[e][b]?a[e][b]:"";g&&!d[g]&&(c.push(g),d[g]=1)}return c},parseTwitterDate:function(a){return new Date(Date.parse(a.replace(/( \+)/," UTC$1")))},throttle:function(a,b){var c,d=b||500;return function(){var b=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(b,Array.prototype.slice.call(e))},d)}}},gb.Namespace(gb,"gb.ui"),gb.ui={ScreenSizes:{sm:480,md:768,lg:992,xl:1200},screenMode:"lg",onResizeHandler:function(){var a=gb.ui.ScreenSizes,b=$(window).width();gb.ui.screenWidth=$(window).width(),gb.ui.screenHeight=$(window).height(),b<a.sm?gb.ui.screenMode="xs":b>=a.sm&&b<a.md?gb.ui.screenMode="sm":b>=a.md&&b<a.lg?gb.ui.screenMode="md":b>=a.lg&&b<a.xl?gb.ui.screenMode="lg":b>=a.xl&&(gb.ui.screenMode="xl"),$(this).trigger("resizeEnd")}},gb.Namespace(gb,"gb.ui.TouchSurface"),gb.ui.TouchSurface=new gb.Class,gb.ui.TouchSurface.include({init:function(a,b){"use strict";try{var c=this;this.touchSurface=a,this.direction="none",this.swipeType="none",this.startX=null,this.startY=null,this.distX=null,this.distY=null,this.threshold=50,this.restraint=50,this.allowedTime=500,this.elapsedTime=null,this.startTime=null,this.touchHandler=b||function(a,b,c,d,e){},this.touchSurface.addEventListener("touchstart",function(a){c.onTouchStart(a)},!1),this.touchSurface.addEventListener("touchmove",function(a){c.onTouchMove(a)},!1),this.touchSurface.addEventListener("touchend",function(a){c.onTouchEnd(a)},!1)}catch(a){}},removeEventListeners:function(){try{this.touchSurface.removeEventListener("touchstart"),this.touchSurface.removeEventListener("touchmove"),this.touchSurface.removeEventListener("touchend")}catch(a){}},debug:function(){console.log("----------------"),console.log("startX",this.startX,"startY",this.startY),console.log("x",this.distX,"y",this.distY,this.axis,this.direction)},onTouchStart:function(a){var b=a.changedTouches[0];a.preventDefault(),this.axis=null,this.direction="none",this.swipeType="none",this.startX=b.pageX,this.startY=b.pageY,this.startTime=(new Date).getTime(),this.touchHandler(a,"none","start",this.swipeType,0)},onTouchMove:function(a){var b=a.changedTouches[0];a.preventDefault(),this.distX=b.pageX-this.startX,this.distY=b.pageY-this.startY,this.axis||(this.axis=Math.abs(this.distX)>Math.abs(this.distY)?"horizontal":"vertical"),"horizontal"===this.axis?(this.direction=this.distX<0?"left":"right",this.touchHandler(a,this.direction,"move",this.swipeType,this.distX)):(this.direction=this.distY<0?"up":"down",this.touchHandler(a,this.direction,"move",this.swipeType,this.distY))},onTouchEnd:function(a){a.preventDefault(),this.elapsedTime=(new Date).getTime()-this.startTime,this.elapsedTime<=this.allowedTime&&(Math.abs(this.distX)>=this.threshold&&Math.abs(this.distY)<=this.restraint?this.swipeType=this.direction:Math.abs(this.distY)>=this.threshold&&Math.abs(this.distX)<=this.restraint&&(this.swipeType=this.direction));var b="left"===this.direction||"right"===this.direction?this.distX:this.distY;this.touchHandler(a,this.direction,"end",this.swipeType,b)}}),gb.Namespace(gb,"gb.ui.LazyImage"),gb.ui.LazyImage=new gb.Class,gb.ui.LazyImage.include({init:function(a){"use strict";var b=this,c=function(a){var b=$(window).scrollTop(),c=b+$(window).height(),d=$(a).offset().top,e=(d+$(a).height(),d<c&&d>b);return e},d=function(a){b.images.trigger("scrollend")};$(window).scroll(gb.util.throttle(d,300)),this.images=$(a),this.images.on("scrollend",function(a){var b=$(a.target),d=b.attr("src"),e=b.attr("data-src");c(b)&&e&&d!==e&&(b.attr("src",e),b.off("scrollend"),b.removeAttr("data-src"))}),$(window).scroll(function(){b.images.trigger("scrollend")}),this.images.trigger("scrollend")}}),gb.Namespace(gb,"gb.ui.PreloadableImage"),gb.ui.PreloadableImage=new gb.Class,gb.ui.PreloadableImage.include({init:function(a,b,c,d){"use strict";this.id=a,this.startTime=(new Date).valueOf(),this.endTime=this.startTime,this.image=new Image,this.setSource(b),this.setOnLoad(c),this.setOnError(d)},setSource:function(a){return a?void(this.image.src=a):void(this.image.src="")},setOnLoad:function(a){var b=this;if(!a||"function"!=typeof a)return void(this.image.onload=function(){b.endTime=(new Date).valueOf()});var c=function(c){b.endTime=(new Date).valueOf(),a(c)};this.image.onload=c},setOnError:function(a){var b=this;return a&&"function"==typeof a?(this.endTime=(new Date).valueOf(),void(this.image.onerror=a)):void(this.image.onerror=function(){b.endTime=(new Date).valueOf()})},getTotalTimeMS:function(){return this.endTime-this.startTime}}),gb.Namespace(gb,"gb.ui.Tile"),gb.ui.Tile=new gb.Class,gb.ui.Tile.include({init:function(a){"use strict";this.jq=$("<div/>",a)},transition:function(a){this.jq.transition(a)},show:function(){this.jq.show()},hide:function(){this.jq.hide()},onResizeEndHandler:function(){console.log("Tile.onResizeEndHandler")},activate:function(){},setContent:function(a){this.jq.append($(a))},deactivate:function(){}}),gb.Namespace(gb,"gb.util.TimeOutCycle"),gb.util.TimeOutCycle=new gb.Class,gb.util.TimeOutCycle.include({init:function(a,b){"use strict";this.timeoutMS=a,this.running=!1,this.timeoutHandle=null,this.tickHandler=function(){console.log("default tickHandler")},this.setTimeoutMS(a),this.setTickHandler(b)},setTickHandler:function(a){a&&"function"==typeof a&&(this.tickHandler=a)},setTimeoutMS:function(a){a&&(this.timeoutMS=a)},start:function(){this.running=!0,this._tick()},stop:function(){this.running=!1,this.timeoutHandle&&clearTimeout(this.timeoutHandle)},isRunning:function(){return this.running===!0},_tick:function(){this.running&&(this.tickHandler(),this._setNext())},_setNext:function(){var a=this;this.running&&(this.timeoutHandle=setTimeout(function(){a._tick()},this.timeoutMS))}}),function(a){a.fn.fullscreen=function(b){"use strict";var c=a.extend({front:"#background",bgHeightClass:"bgheight",bgWidthClass:"bgwidth",refreshInterval:5e3,fadeOutTime:500,fadeInTime:700,successCallback:function(){},errorCallback:function(){},images:["images/image-001.png","images/image-002.png","images/image-003.png"]},b),d=a(window),e=a(c.front),f=d.width()/d.height(),g=e.width()/e.height(),h=null,i=[],j=0,k=function(){var a=i[j].image.width,b=i[j].image.height;g=a/b,f=d.width()/d.height(),f>g?e.removeClass().addClass(c.bgWidthClass):e.removeClass().addClass(c.bgHeightClass)},l=function(){j<c.images.length-1?j++:j=0;var a=function(){e.attr("src",c.images[j]),e.transition({opacity:1},c.fadeInTime,"snap"),k()};e.transition({opacity:0},c.fadeOutTime,"snap",a)},m=function(){for(var a=0,b=c.images.length;a<b;a++){var d="img"+a,e=c.images[a],f=new gb.ui.PreloadableImage(d,e,c.successCallback,c.errorCallback);i.push(f)}},n=function(){d.on("resizeEnd",k),h||(h=setInterval(l,c.refreshInterval))};return m(),n(),this}}(jQuery),function(a){a.fn.search=function(b){"use strict";var c=this,d=null,e=null,f=a.extend({input:"search-field",results:"search-results",minchars:4,requestInterval:3e3},b),g=function(a,b){var d="<div class='heading'>"+a+": "+b+"</div>";c.resultsDiv.append(d)},h=function(a,b){var d=b.tracks;if(b.count&&d&&d.length){g(a,b.count);for(var e=0,f=d.length;e<f;e++){var h="<div class='track'><div class='title'>"+d[e].Name+"</div><div class='normal'>"+d[e].Artist+"</div><div class='normal'>"+d[e].Album+"</div></div>";c.resultsDiv.append(h)}}},i=function(a,b){var d=b.tracks;if(b.count&&d&&d.length){g(a,b.count);for(var e=0,f=d.length;e<f;e++){var h="<div class='track'><div class='title'>"+d[e]._id+" <span class='count'>"+d[e].value+"</span></div></div>";c.resultsDiv.append(h)}}},j=function(){c.resultsDiv.empty(),c.resultsDiv.hide()},k=function(a){c.resultsDiv.show();var b=a.keys;if(c.resultsDiv.empty(),a.total){var d="<div class='found'>Found: "+a.total+"</div>";c.resultsDiv.append(d);for(var e=0,f=b.length;e<f;e++){var g=b[e],j=a.data[g];"find"===a.data[g].type?h(g,j):i(g,j)}}else c.resultsDiv.append("<div class='none-found'>No results found.</div>")},l=function(){var b=c.searchInput.val().trim();if(b.length<f.minchars)return void j();if(b!==e){e=b;var d="/multi/"+b;a.ajax(d,{type:"GET",dataType:"json",success:function(a,b,c){console.log("success:",b),k(a)}})}};this.onResize=function(){if(c.searchInput){var a=c.searchInput.position(),b=c.searchInput.outerWidth(!0),d=c.searchInput.outerHeight(!0);c.resultsDiv.css({position:"absolute",top:a.top+d+10+"px",left:a.left+"px",width:b+"px",height:"600px"})}};var m=function(){return c.searchInput=a("#"+f.input),"undefined"==typeof c.searchInput[0]?null:(d||(d=setInterval(l,f.requestInterval)),c.searchInput.after("<div id='"+f.results+"'></div>"),c.resultsDiv=a("#"+f.results),c.onResize(),c.resultsDiv.hide(),c)};return m()}}(jQuery),$(function(){var a=$("#search-field").search();a&&$(window).resize(gb.util.throttle(a.onResize,500))}),gb.Namespace(gb,"gb.ui.Timeline"),gb.ui.Timeline=new gb.Class,gb.ui.Timeline.include({MONTHS:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],init:function(a){"use strict";this.x=0,this.y=0,this.margin=70,this.trackHeight=24,this.yTrack=200,this.paper=null,this.selected=null,this.startDateLabel=null,this.endDateLabel=null,this.htmlContent=null,this.id=a,this.jqContainer=$("#"+this.id),this.ajaxURL="/api/timeline",this.timelineData=null;var b=this;$("#stage").on("goto-end",function(a){b.onResizeEndHandler()}),$.getJSON(this.ajaxURL,function(a){b.timelineData=a,b.onDataHandler()})},resize:function(){this.htmlContent||(this.htmlContent=this.jqContainer.html()),this.width=this.jqContainer.width(),this.height=this.jqContainer.height(),this.trackWidth=this.width-2*this.margin,this.paper&&this.paper.clear(),this.width>768?(this.jqContainer.empty(),this.paper=Raphael(this.id,this.width,this.height),this.processData(this.timelineData),this.draw()):this.jqContainer.html(this.htmlContent)},processData:function(a){this.dataPoints=[];for(var b=null,c=null,d=a.length,e=null,f=0,g=d;f<g;f++)e=a[f],e.startDate&&(b=b?Math.min(e.startDate,b):e.startDate,c=c?Math.max(e.startDate,c):e.startDate),e.endDate||(e.endDate=(new Date).valueOf()),b=b?Math.min(e.endDate,b):e.endDate,c=c?Math.max(e.endDate,c):e.endDate;var h=c-b;for(this.xMin=b,this.xMax=c,this.xScale=this.trackWidth/h,f=0,g=d;f<g;f++)e=a[f],e.xStart=Math.floor(this.margin+this.xScale*(e.startDate-b)),e.xEnd=Math.floor(this.margin+this.xScale*(e.endDate-b)),this.dataPoints.push(e)},draw:function(){var a=this,b="M"+(this.x+this.margin)+" "+this.yTrack+"L"+(this.width-this.margin)+" "+this.yTrack;this.track=this.paper.path(b);var c={stroke:"#ccc","stroke-width":this.trackHeight,"stroke-linecap":"round"};this.track.attr(c);for(var d=function(b){var c=this.data("startPoint"),d=this.data("endPoint"),e=this.data("dataPoint");if(a.selected=a.drawSegment(e.startDate,e.endDate),a.selected.animate({opacity:1},500,"easeInOut"),c.stop(),c.toFront(),d.stop(),d.toFront(),c.animate({fill:"#DE001E"},50,"linear"),d.animate({cx:e.xEnd,fill:"#FF8400"},300,"easeInOut"),a.drawHeader(e),a.startDateLabel&&a.startDateLabel.remove(),a.endDateLabel&&a.endDateLabel.remove(),this.toFront(),a.startDateLabel=a.drawDate(e.startDate),a.endDateLabel=a.drawDate(e.endDate),a.startDateLabel.animate({opacity:1},300,"easeInOut"),e.startDate!==e.endDate){var f=a.startDateLabel.getBBox().x2,g=a.endDateLabel.getBBox().x;f>g&&a.endDateLabel.transform("T20,0"),a.endDateLabel.animate({opacity:1},300,"easeInOut")}},e=function(b){var c=this.data("startPoint"),d=this.data("endPoint"),e=this.data("dataPoint");a.selected&&a.selected.remove(),a.startDateLabel&&a.startDateLabel.remove(),a.endDateLabel&&a.endDateLabel.remove(),c.animate({fill:"#333"},50,"linear"),d.animate({cx:e.xStart,fill:"#999"},500,"easeInOut")},f=function(a){this.data("dataPoint")},g={hoverPoint:{fill:"#00b","stroke-width":"0",opacity:0},startPoint:{opacity:0,cx:0,fill:"#ccc","stroke-width":"0"},endPoint:{fill:"#999","stroke-width":"0"}},h=0,i=this.dataPoints.length;h<i;h++){var j=this.dataPoints[h],k=this.paper.circle(j.xStart,this.yTrack,15);k.attr(g.hoverPoint);var l=this.paper.circle(j.xStart,this.yTrack,10);l.attr(g.startPoint),l.animate({opacity:1,fill:"#333",cx:j.xStart},100*h,"easeInOut");var m=this.paper.circle(j.xStart,this.yTrack,5);m.attr(g.endPoint),k.toFront(),k.data("dataPoint",j),k.data("startPoint",l),k.data("endPoint",m),k.hoverInBounds(d,e),k.click(f)}var n=this.dataPoints.length-1;this.drawHeader(this.dataPoints[n]),this.drawTicks()},drawHeader:function(a){var b={fill:"#fff","font-size":"32pt","text-anchor":"start","font-family":"Source Sans Pro"},c={fill:"#fff","font-size":"16pt","text-anchor":"start","font-family":"Source Sans Pro"},d={fill:"#fff","font-size":"16pt","text-anchor":"start","font-family":"Source Sans Pro"};this.title&&this.title.remove(),this.title=this.paper.text(this.margin,40,a.title),this.title.attr(b),this.subhead&&this.subhead.remove(),this.subhead=this.paper.text(this.margin,70,a.employer),this.subhead.attr(c),this.location&&this.location.remove(),this.location=this.paper.text(this.margin,94,a.location),this.location.attr(d)},drawTicks:function(){for(var a={fill:"#fff","font-size":"10pt","font-family":"Source Sans Pro"},b=new Date(this.dataPoints[0].startDate),c=b.getUTCFullYear(),d=new Date(this.dataPoints[this.dataPoints.length-1].endDate),e=d.getUTCFullYear(),f=c+1;f<=e;f++){var g=new Date("Jan 1, "+f).valueOf(),h=Math.floor(this.margin+(g-this.xMin)*this.xScale);this.paper.text(h,this.yTrack+30,f).attr(a)}},drawDate:function(a){var b={opacity:0,fill:"#fff","font-size":"16pt","font-family":"Source Sans Pro"},c={opacity:0,fill:"#fff","font-size":"12pt","font-family":"Source Sans Pro"},d=Math.floor(this.margin+(a-this.xMin)*this.xScale),e=new Date(a),f=this.MONTHS[e.getUTCMonth()],g=e.getUTCFullYear(),h=this.paper.set();return h.push(this.paper.text(d,this.yTrack-40,f).attr(b),this.paper.text(d,this.yTrack-20,g).attr(c)),h},drawSegment:function(a,b){var c=Math.floor(this.margin+(a-this.xMin)*this.xScale),d=Math.floor(this.margin+(b-this.xMin)*this.xScale),e="M"+c+" "+this.yTrack+"L"+d+" "+this.yTrack;this.selected&&this.selected.remove(),e=this.paper.path(e);var f={opacity:.7,stroke:"#FAD905","stroke-width":this.trackHeight-4,"stroke-linecap":"round"};return e.attr(f)},onResizeEndHandler:function(){this.paper&&this.paper.clear(),this.resize();gb.util.throttle(function(){},500)},onDataHandler:function(){var a=this;$(window).on("resizeEnd",function(){a.onResizeEndHandler()}),$(window).on("resize",function(){a.paper&&a.paper.clear()}),this.onResizeEndHandler()}}),gb.Namespace(gb,"gb.ui.FullScreen"),gb.ui.FullScreen=new gb.Class,gb.ui.FullScreen.include({init:function(){"use strict";this.spinner=$("#spinner"),this.spinner.show(),this.images=[],this.howMany=3,this.countLoaded=0,this.initImageList(),this.initBackground(),console.log("init: FullScreen.")},initBackground:function(){var a=this;$("body").fullscreen({refreshInterval:3e4,fadeOutTime:5e3,fadeInTime:3e3,successCallback:function(){a.checkSpinner()},errorCallback:function(){a.checkSpinner()},images:this.images})},checkSpinner:function(){this.countLoaded++,this.countLoaded===this.howMany&&this.spinner.hide()},initImageList:function(){this.images=[];for(var a=1;a<=this.howMany;a++){var b=gb.util.zeroFill(a,3);this.images.push(gb.ui.mediaHost+"/images/image-"+b+".jpg")}}}),gb.Namespace(gb,"gb.ui.Stage"),gb.ui.Stage=gb.Class(gb.ui.Tile),gb.ui.Stage.include({init:function(a,b,c){"use strict";var d=this;this.intervalMS=b,this.currentIndex=0,this.initTiles(),a&&(this.selector=a,this.jq=$("#"+a),this.contentSelector="#"+a+"-content",this.content=$("<div id='"+a+"-content'></div>"),this.jq.append(this.content),this.setupEventHandlers(),this.timeoutCycle=new gb.util.TimeOutCycle(this.intervalMS,function(){d.rotate()}),c?setTimeout(function(){console.log("Stage wait:",c),d.start()},c):d.start())},setupEventHandlers:function(){var a=this;this.touchSurface=new gb.ui.TouchSurface(this.content[0],function(b,c,d,e,f){a.onTouchEvent(b,c,d,e,f)}),$("#stage-next").on("click",function(){a.goToNext()}),$("#stage-prev").on("click",function(){a.goToPrevious()})},initTiles:function(){this.tiles=[],this.tileOffsets=[]},addTile:function(a){this.tiles.push(a),this.content.append(a.jq)},onTouchEvent:function(a,b,c,d,e){if("move"===c&&this.tileOffsets){var f=3,g=-1*this.tileOffsets[this.currentIndex]+e*f,h=-1*(this.tileOffsets[1]*(this.tileOffsets.length-1));if(!(g<0&&g>h))return;this.content.css({x:g})}if("end"===c)switch(b){case"left":this.goToNext();break;case"right":this.goToPrevious()}},resizeTiles:function(){for(var a=0,b=this.jq.width(),c=this.jq.height(),d=this.tiles,e=0,f=d.length;e<f;e++){d[e].jq.width(b),d[e].jq.height(c);var g=d[e].jq.get(0);g&&(g.style.top="0px",g.style.left=a+"px"),this.tileOffsets[e]=a,a+=b}},isRunning:function(){return this.timeoutCycle.isRunning()===!0},start:function(){this.timeoutCycle.start()},stop:function(){this.timeoutCycle.stop()},rotate:function(){this.currentIndex<this.tiles.length-1?this.goToNext():this.goTo(0)},goToPrevious:function(){this.currentIndex>0?this.currentIndex--:this.currentIndex=0,this.goTo(this.currentIndex)},goToNext:function(){this.currentIndex<this.tiles.length-1?this.currentIndex++:this.currentIndex=0,this.goTo(this.currentIndex)},goTo:function(a){var b=this;this.currentIndex&&this.tiles[this.currentIndex].jq.transition({opacity:0,queue:!1},100,"ease"),this.currentIndex=a;var c=-1*this.tileOffsets[a];this.content.transition({x:c,queue:!1},200,"ease",function(){b.jq.trigger({type:"goto-end",slideIndex:a,slideXOffset:c});var d=b.tiles[b.currentIndex].jq;d.show(),d.transition({opacity:1,queue:!1},300,"ease")})},show:function(){this.jq.css({opacity:1}),this.goTo(this.currentIndex)},hide:function(){this.jq.hide()},fadeOut:function(){this.jq.css({opacity:0})},onResizeEndHandler:function(){this.resizeTiles(),this.show()}}),gb.Namespace(gb,"gb.ui.ContentManager"),gb.ui.ContentManager=new gb.Class,gb.ui.ContentManager.include({COLORS:["#333","#3E606F","#002A4A","#FF9311","#E33200","#002A4A","#D1DBBD","#91AA9D","#3E606F","#193441","#3C3658","#3EC8B7","#7CD0B4","#B9D8B1","#F7E0AE","#FFF1CE","#17607D"],init:function(a){"use strict";var b=this,c=15e3,d=5e3;if(this.content=$(a),this.content.html()){this.visible=!0,this.stage=new gb.ui.Stage("stage",c,d);var e=new gb.ui.Tile({id:"splash-tile",class:"tile"});e.setContent('<img src="http://cdn.suayan.com/dist/img/splash-04.svg"/>'),this.stage.addTile(e);var f=new gb.ui.Tile({id:"timeline-tile",class:"tile"});this.stage.addTile(f);new gb.ui.Timeline("timeline-tile");this.loadTileData(function(a){console.log("Added "+a+" additional tiles from api call."),b.stage.onResizeEndHandler()}),$("#slideshow-button").click(function(){b.toggleSlideShow()}),$("#play-button").click(function(){b.toggleStage()}),$(window).on("resizeEnd",function(){b.onResizeEndHandler()}),console.log("init: ContentManager 2016.12.07")}},loadTileData:function(a){var b=this,c=0;$.get("/api/tiles",function(d){for(var e=JST["handlebars/tile.hbs"],f=0,g=d.length;f<g;f++){var h=e(d[f]),i=new gb.ui.Tile({id:"tile-"+f,class:"tile"});i.hide(),i.setContent(h),b.setTileColor(i,c),b.stage.addTile(i),c>b.COLORS.length?c=0:c++}a&&"function"==typeof a&&a(d.length)})},setTileColor:function(a,b){var c=a.jq.get(0);c&&(c.style.backgroundColor=this.COLORS[b])},onResizeEndHandler:function(){this.stage.onResizeEndHandler()},toggleSlideShow:function(){this.visible=!this.visible,this.visible?($(".glyphicon-home").removeClass("glyphicon-home").addClass("glyphicon-picture"),this.show(),$(".container").fadeIn()):($(".glyphicon-picture").removeClass("glyphicon-picture").addClass("glyphicon-home"),this.hide(),$(".container").fadeOut())},toggleStage:function(){this.stage.isRunning()?($(".glyphicon-pause").removeClass("glyphicon-pause").addClass("glyphicon-play"),this.stage.stop()):($(".glyphicon-play").removeClass("glyphicon-play").addClass("glyphicon-pause"),this.stage.start())},show:function(){var a=this;this.content.transition({opacity:1},800,function(){a.content.attr({visibility:"visible",display:"block"})})},hide:function(){var a=this;this.content.transition({opacity:0},800,function(){a.content.attr({visibility:"hidden",display:"none"})})}}),$(function(){"use strict";var a=(new gb.ui.ContentManager("#content"),$(window));if(a.resize(gb.util.throttle(gb.ui.onResizeHandler,300)),$("#stream").length){var b=$("#stream"),c=JST["handlebars/streamInstagram.hbs"],d=JST["handlebars/streamTwitter.hbs"],e=JST["handlebars/streamVimeo.hbs"];a.on("resizeEnd",function(){var a=b.width()-40,c=a/16*9;b.find("iframe").attr("width",a).attr("height",c)}),$.ajax({url:"/api/stream",success:function(f){if(f&&"ok"===f.status){for(var g=f.data,h=0,i=g.length;h<i;h++){var j=g[h],k="";j.ago=moment(j.dateCreated).fromNow(),"instagram"===j.type?k=$(c(j)):"twitter"===j.type?(j.permalink=j.entities.urls.length?j.entities.urls[0].expanded_url:"",k=$(d(j))):"vimeo"===j.type&&(k=$(e(j))),b.append(k)}console.log("lazyImages...");
new gb.ui.LazyImage("img.lazy");a.trigger("resizeEnd")}}})}});