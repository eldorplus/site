/*! site 2013-12-23 */

var gb=gb||{};gb.Namespace=function(a,b){var c,d,e=b.split("."),f=a;for("gb"==e[0]&&(e=e.slice(1)),c=e.length,d=0;c>d;d++)"undefined"==typeof f[e[d]]&&(f[e[d]]={}),f=f[e[d]];return f},gb.Class=function(a){var b=function(){this.init.apply(this,arguments)};if(a){var c=function(){};c.prototype=a.prototype,b.prototype=new c}return b.prototype.init=function(){},b.fn=b.prototype,b.fn.parent=b,b.extend=function(a){var c=a.extended;for(var d in a)b[d]=a[d];c&&c(b)},b.include=function(a){var c=a.included;for(var d in a)b.fn[d]=a[d];c&&c(b)},b},gb.Namespace(gb,"gb.util"),gb.util.RandomArray=function(a,b){for(var c=new Array(a),d=0;a>d;d++)c[d]=Math.floor(Math.random()*(b+1));return c},gb.util.ArrayMax=function(a){return Math.max.apply(Math,a)},gb.util.ArrayMin=function(a){return Math.min.apply(Math,a)},gb.util.ZeroFill=function(a,b){return b-=a.toString().length,b>0?new Array(b+(/\./.test(a)?2:1)).join("0")+a:a+""},gb.util.throttle=function(a,b){var c,d=b||500;return function(){var b=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(b,Array.prototype.slice.call(e))},d)}},gb.Namespace(gb,"gb.ui"),gb.ui.ScreenSizes={sm:480,md:768,lg:992,xl:1200},gb.ui.screenMode="lg",gb.ui.onResizeHandler=function(){var a=gb.ui.ScreenSizes,b=$(window).width();gb.ui.screenWidth=$(window).width(),gb.ui.screenHeight=$(window).height(),b<a.sm?gb.ui.screenMode="xs":b>=a.sm&&b<a.md?gb.ui.screenMode="sm":b>=a.md&&b<a.lg?gb.ui.screenMode="md":b>=a.lg&&b<a.xl?gb.ui.screenMode="lg":b>=a.xl&&(gb.ui.screenMode="xl"),$(this).trigger("resizeEnd")},gb.Namespace(gb,"gb.ui.PreloadableImage"),gb.ui.PreloadableImage=new gb.Class,gb.ui.PreloadableImage=function(a,b,c,d){"use strict";this.id=a,this.startTime=(new Date).valueOf(),this.endTime=this.startTime,this.image=new Image,this.SetSource(b),this.SetOnLoad(c),this.SetOnError(d)},gb.ui.PreloadableImage.prototype.SetSource=function(a){return a?(this.image.src=a,void 0):(this.image.src="",void 0)},gb.ui.PreloadableImage.prototype.SetOnLoad=function(a){var b=this;if(!a||"function"!=typeof a)return this.image.onload=function(){b.endTime=(new Date).valueOf()},void 0;var c=function(c){b.endTime=(new Date).valueOf(),a(c)};this.image.onload=c},gb.ui.PreloadableImage.prototype.SetOnError=function(a){var b=this;return a&&"function"==typeof a?(this.endTime=(new Date).valueOf(),this.image.onerror=a,void 0):(this.image.onerror=function(){b.endTime=(new Date).valueOf()},void 0)},gb.ui.PreloadableImage.prototype.GetTotalTimeMS=function(){return this.endTime-this.startTime},gb.Namespace(gb,"gb.ui.Tile"),gb.ui.Tile=new gb.Class,gb.ui.Tile.include({init:function(a,b){"use strict";this.jq=$("<div/>",b).appendTo(a)},transition:function(a){this.jq.transition(a)},show:function(){this.jq.show()},hide:function(){this.jq.hide()},onResizeEndHandler:function(){console.log("Tile.onResizeEndHandler")},activate:function(){},deactivate:function(){}}),gb.Namespace(gb,"gb.util.TimeOutCycle"),gb.util.TimeOutCycle=new gb.Class,gb.util.TimeOutCycle=function(a,b){"use strict";this.timeoutMS=a,this.isRunning=!1,this.timeoutHandle=null,this.tickHandler=function(){console.log("default tickHandler")},this.setTimeoutMS(a),this.setTickHandler(b)},gb.util.TimeOutCycle.prototype.setTickHandler=function(a){a&&"function"==typeof a&&(this.tickHandler=a)},gb.util.TimeOutCycle.prototype.setTimeoutMS=function(a){a&&(this.timeoutMS=a)},gb.util.TimeOutCycle.prototype.start=function(){this.isRunning=!0,this._tick()},gb.util.TimeOutCycle.prototype.stop=function(){this.isRunning=!1,this.timeoutHandle&&clearTimeout(this.timeoutHandle)},gb.util.TimeOutCycle.prototype._tick=function(){this.isRunning&&(this.tickHandler(),this._setNext())},gb.util.TimeOutCycle.prototype._setNext=function(){var a=this;this.isRunning&&(this.timeoutHandle=setTimeout(function(){a._tick()},this.timeoutMS))},function(a){a.fn.fullscreen=function(b){var c=a.extend({front:"#background",bgHeightClass:"bgheight",bgWidthClass:"bgwidth",refreshInterval:5e3,fadeOutTime:500,fadeInTime:700,successCallback:function(){},errorCallback:function(){},images:["images/image-001.png","images/image-002.png","images/image-003.png"]},b),d=a(window),e=a(c.front),f=d.width()/d.height(),g=e.width()/e.height(),h=null,i=[],j=0,k=function(){j<c.images.length-1?j++:j=0;var a=function(){e.attr("src",c.images[j]),e.transition({opacity:1},c.fadeInTime,"snap"),l()};e.transition({opacity:0},c.fadeOutTime,"snap",a)},l=function(){var a=i[j].image.width,b=i[j].image.height;g=a/b,f=d.width()/d.height(),f>g?e.removeClass().addClass(c.bgWidthClass):e.removeClass().addClass(c.bgHeightClass)},m=function(){for(var a=0,b=c.images.length;b>a;a++){var d="img"+a,e=c.images[a],f=new gb.ui.PreloadableImage(d,e,c.successCallback,c.errorCallback);i.push(f)}},n=function(){d.on("resizeEnd",l),h||(h=setInterval(k,c.refreshInterval))};return m(),n(),this}}(jQuery),function(a){a.fn.search=function(b){var c=this,d=null,e=null,f=a.extend({input:"search-field",results:"search-results",minchars:4,requestInterval:3e3},b),g=function(a,b){var d="<div class='heading'>"+a+": "+b+"</div>";c.resultsDiv.append(d)},h=function(a,b){var d=b.tracks;if(b.count&&d&&d.length){g(a,b.count);for(var e=0,f=d.length;f>e;e++){var h="<div class='track'><div class='title'>"+d[e].Name+"</div><div class='normal'>"+d[e].Artist+"</div><div class='normal'>"+d[e].Album+"</div></div>";c.resultsDiv.append(h)}}},i=function(a,b){var d=b.tracks;if(b.count&&d&&d.length){g(a,b.count);for(var e=0,f=d.length;f>e;e++){var h="<div class='track'><div class='title'>"+d[e]._id+" <span class='count'>"+d[e].value+"</span></div></div>";c.resultsDiv.append(h)}}},j=function(){c.resultsDiv.empty(),c.resultsDiv.hide()},k=function(a){c.resultsDiv.show();var b=a.keys;if(c.resultsDiv.empty(),a.total){var d="<div class='found'>Found: "+a.total+"</div>";c.resultsDiv.append(d);for(var e=0,f=b.length;f>e;e++){var g=b[e],j=a.data[g];"find"===a.data[g].type?h(g,j):i(g,j)}}else c.resultsDiv.append("<div class='none-found'>No results found.</div>")},l=function(){var b=c.searchInput.val().trim();if(b.length<f.minchars)return j(),void 0;if(b!==e){e=b;var d="/multi-search/"+b;a.ajax({url:d,type:"GET",dataType:"json",success:function(a,b){console.log("success:",b),k(a)}})}};this.onResize=function(){if(c.searchInput){var a=c.searchInput.position(),b=c.searchInput.outerWidth(!0),d=c.searchInput.outerHeight(!0);c.resultsDiv.css({position:"absolute",top:a.top+d+10+"px",left:a.left+"px",width:b+"px",height:"600px"})}};var m=function(){return c.searchInput=a("#"+f.input),"undefined"==typeof c.searchInput[0]?null:(d||(d=setInterval(l,f.requestInterval)),c.searchInput.after("<div id='"+f.results+"'></div>"),c.resultsDiv=a("#"+f.results),c.onResize(),c.resultsDiv.hide(),c)};return m()}}(jQuery),$(function(){var a=$("#search-field").search();a&&$(window).resize(gb.util.throttle(a.onResize,500))}),$(function(){var a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],b=function(a){this.x=0,this.y=0,this.margin=40,this.trackHeight=24,this.yTrack=160,this.paper=null,this.selected=null,this.startDateLabel=null,this.endDateLabel=null,this.htmlContent=null,this.id="timeline",this.jqContainer=$("#"+this.id),this.ajaxURL="/api/timeline",this.timelineData=null,a&&"function"==typeof a&&(this.onDataHandler=a);var b=this;$.getJSON(this.ajaxURL,function(c){b.timelineData=c,a()})};b.prototype.Resize=function(){this.htmlContent||(this.htmlContent=this.jqContainer.html()),this.width=this.jqContainer.width(),this.height=this.jqContainer.height(),this.trackWidth=this.width-2*this.margin,this.paper&&this.paper.clear(),this.width>768?(this.jqContainer.empty(),this.paper=Raphael(this.id,this.width,this.height),this.ProcessData(this.timelineData),this.Draw()):this.jqContainer.html(this.htmlContent)},b.prototype.ProcessData=function(a){this.dataPoints=[];for(var b=null,c=null,d=a.length,e=null,f=0,g=d;g>f;f++)e=a[f],e.startDate&&(b=b?Math.min(e.startDate,b):e.startDate,c=c?Math.max(e.startDate,c):e.startDate),e.endDate||(e.endDate=(new Date).valueOf()),b=b?Math.min(e.endDate,b):e.endDate,c=c?Math.max(e.endDate,c):e.endDate;var h=c-b;for(this.xMin=b,this.xMax=c,this.xScale=this.trackWidth/h,f=0,g=d;g>f;f++)e=a[f],e.xStart=Math.floor(this.margin+this.xScale*(e.startDate-b)),e.xEnd=Math.floor(this.margin+this.xScale*(e.endDate-b)),this.dataPoints.push(e)},b.prototype.Draw=function(){var a=this,b="M"+(this.x+this.margin)+" "+this.yTrack+"L"+(this.width-this.margin)+" "+this.yTrack;this.track=this.paper.path(b);var c={stroke:"#ccc","stroke-width":this.trackHeight,"stroke-linecap":"round"};this.track.attr(c);for(var d=function(){var b=this.data("startPoint"),c=this.data("endPoint"),d=this.data("dataPoint");if(a.selected=a.DrawSegment(d.startDate,d.endDate),a.selected.animate({opacity:1},500,"easeInOut"),b.stop(),b.toFront(),c.stop(),c.toFront(),b.animate({fill:"#DE001E"},50,"linear"),c.animate({cx:d.xEnd,fill:"#FF8400"},300,"easeInOut"),a.DrawHeader(d),a.startDateLabel&&a.startDateLabel.remove(),a.endDateLabel&&a.endDateLabel.remove(),this.toFront(),a.startDateLabel=a.DrawDate(d.startDate),a.endDateLabel=a.DrawDate(d.endDate),a.startDateLabel.animate({opacity:1},300,"easeInOut"),d.startDate!=d.endDate){var e=a.startDateLabel.getBBox().x2,f=a.endDateLabel.getBBox().x;e>f&&a.endDateLabel.transform("T20,0"),a.endDateLabel.animate({opacity:1},300,"easeInOut")}},e=function(){var b=this.data("startPoint"),c=this.data("endPoint"),d=this.data("dataPoint");a.selected&&a.selected.remove(),a.startDateLabel&&a.startDateLabel.remove(),a.endDateLabel&&a.endDateLabel.remove(),b.animate({fill:"#333"},50,"linear"),c.animate({cx:d.xStart,fill:"#999"},500,"easeInOut")},f=function(){this.data("dataPoint")},g={hoverPoint:{fill:"#00b","stroke-width":"0",opacity:0},startPoint:{opacity:0,cx:0,fill:"#ccc","stroke-width":"0"},endPoint:{fill:"#999","stroke-width":"0"}},h=0,i=this.dataPoints.length;i>h;h++){var j=this.dataPoints[h],k=this.paper.circle(j.xStart,this.yTrack,15);k.attr(g.hoverPoint);var l=this.paper.circle(j.xStart,this.yTrack,10);l.attr(g.startPoint),l.animate({opacity:1,fill:"#333",cx:j.xStart},100*h,"easeInOut");var m=this.paper.circle(j.xStart,this.yTrack,5);m.attr(g.endPoint),k.toFront(),k.data("dataPoint",j),k.data("startPoint",l),k.data("endPoint",m),k.hoverInBounds(d,e),k.click(f)}var n=this.dataPoints.length-1;this.DrawHeader(this.dataPoints[n]),this.DrawTicks()},b.prototype.DrawHeader=function(a){var b={"font-size":"32pt","text-anchor":"start","font-family":"Source Sans Pro"},c={"font-size":"16pt","text-anchor":"start","font-family":"Source Sans Pro"},d={"font-size":"16pt","text-anchor":"start","font-family":"Source Sans Pro"};this.title&&this.title.remove(),this.title=this.paper.text(this.margin,40,a.title),this.title.attr(b),this.subhead&&this.subhead.remove(),this.subhead=this.paper.text(this.margin,70,a.employer),this.subhead.attr(c),this.location&&this.location.remove(),this.location=this.paper.text(this.margin,94,a.location),this.location.attr(d)},b.prototype.DrawTicks=function(){for(var a={fill:"#333","font-size":"10pt","font-family":"Source Sans Pro"},b=new Date(this.dataPoints[0].startDate),c=b.getUTCFullYear(),d=new Date(this.dataPoints[this.dataPoints.length-1].endDate),e=d.getUTCFullYear(),f=c+1;e>=f;f++){var g=new Date("Jan 1, "+f).valueOf(),h=Math.floor(this.margin+(g-this.xMin)*this.xScale);this.paper.text(h,this.yTrack+30,f).attr(a)}},b.prototype.DrawDate=function(b){var c={opacity:0,fill:"#333","font-size":"16pt","font-family":"Source Sans Pro"},d={opacity:0,fill:"#333","font-size":"12pt","font-family":"Source Sans Pro"},e=Math.floor(this.margin+(b-this.xMin)*this.xScale),f=new Date(b),g=a[f.getUTCMonth()],h=f.getUTCFullYear(),i=this.paper.set();return i.push(this.paper.text(e,this.yTrack-40,g).attr(c),this.paper.text(e,this.yTrack-20,h).attr(d)),i},b.prototype.DrawSegment=function(a,b){var c=Math.floor(this.margin+(a-this.xMin)*this.xScale),d=Math.floor(this.margin+(b-this.xMin)*this.xScale),e="M"+c+" "+this.yTrack+"L"+d+" "+this.yTrack;this.selected&&this.selected.remove(),e=this.paper.path(e);var f={opacity:.7,stroke:"#FAD905","stroke-width":this.trackHeight-4,"stroke-linecap":"round"};return e.attr(f)};var c=function(){e.paper&&e.paper.clear(),e.Resize()},d=function(){$(window).on("resizeEnd",c),$(window).on("resize",function(){e.paper&&e.paper.clear()}),c()},e=new b(d)}),gb.Namespace(gb,"gb.ui.FullScreen"),gb.ui.FullScreen=new gb.Class,gb.ui.FullScreen.include({init:function(){"use strict";this.spinner=$("#spinner"),this.spinner.show(),this.mediaHost="//media.suayan.com/",this.images=[],this.howMany=3,this.countLoaded=0,this.initImageList(),this.initBackground(),console.log("init: FullScreen.")},initBackground:function(){var a=this;$("body").fullscreen({refreshInterval:3e4,fadeOutTime:5e3,fadeInTime:3e3,successCallback:function(){a.checkSpinner()},errorCallback:function(){a.checkSpinner()},images:this.images})},checkSpinner:function(){this.countLoaded++,this.countLoaded==this.howMany&&this.spinner.hide()},initImageList:function(){this.images=[];for(var a=1;a<=this.howMany;a++){var b=gb.util.ZeroFill(a,3);this.images.push(this.mediaHost+"images/image-"+b+".jpg")}}}),gb.Namespace(gb,"gb.ui.Stage"),gb.ui.Stage=gb.Class(gb.ui.Tile),gb.ui.Stage.include({colors:["#FFFFFF","#D1DBBD","#91AA9D","#3E606F","#193441","#002A4A","#17607D","#FFF1CE","#FF9311","#E33200","#3C3658","#3EC8B7","#7CD0B4","#B9D8B1","#F7E0AE"],init:function(a){"use strict";var b=this;this.tiles=[],this.tileOffsets=[],this.howMany=15,this.intervalMS=15e3,this.currentIndex=0,this.selector=a,this.jq=$("#"+a),this.contentSelector="#"+a+"-content",this.content=$("<div id='"+a+"-content'></div>"),this.jq.append(this.content),this.initTiles(),this.show(),this.timeoutCycle=new gb.util.TimeOutCycle(this.intervalMS,function(){b.rotate()}),this.timeoutCycle.start(),$(window).resize(function(){b.hide()}),$("#stage-next").on("click",function(){b.goToNext()}),$("#stage-prev").on("click",function(){b.goToPrevious()}),console.log("init: Stage.")},initTiles:function(){this.tiles=[],this.tileOffsets=[];for(var a=0,b=0;b<this.howMany;b++){var c=new gb.ui.Tile(this.contentSelector,{id:"tile-"+b,"class":"tile"});c.jq.html("<p>Tile: "+b+"</p>");var d=c.jq.get(0);d.style.backgroundColor=this.colors[a],this.tiles.push(c),a>this.colors.length-2?a=0:a++}this.resizeTiles()},resizeTiles:function(){for(var a=0,b=this.jq.width(),c=this.jq.height(),d=this.tiles,e=0,f=d.length;f>e;e++){d[e].jq.width(b),d[e].jq.height(c);var g=d[e].jq.get(0);g.style.top="0px",g.style.left=a+"px",this.tileOffsets[e]=a,a+=b}},rotate:function(){this.currentIndex<this.tiles.length-1?this.goToNext():this.goTo(0)},goToPrevious:function(){this.currentIndex>0?this.currentIndex--:this.currentIndex=0,this.goTo(this.currentIndex)},goToNext:function(){this.currentIndex<this.tiles.length-2?this.currentIndex++:this.currentIndex=this.tiles.length-1,this.goTo(this.currentIndex)},goTo:function(a){this.currentIndex=a;var b=-1*this.tileOffsets[a];this.content.transition({x:b},2e3,"snap")},show:function(){this.jq.hide(),this.goTo(this.currentIndex),this.jq.show()},onResizeEndHandler:function(){this.resizeTiles(),this.show()}}),gb.Namespace(gb,"gb.ui.ContentManager"),gb.ui.ContentManager=new gb.Class,gb.ui.ContentManager.include({init:function(a){"use strict";this.content=$(a),this.visible=!0,this.fullscreen=new gb.ui.FullScreen,this.stage=new gb.ui.Stage("stage");var b=this;$("#slideshow-button").click(function(){b.toggleSlideShow()}),$(window).on("resizeEnd",function(){b.onResizeEndHandler()}),console.log("init: ContentManager")},onResizeEndHandler:function(){this.stage.onResizeEndHandler()},toggleSlideShow:function(){this.visible=!this.visible,this.visible?this.show():this.hide()},show:function(){var a=this;this.content.transition({opacity:1},2e3,function(){a.content.attr({visibility:"visible",display:"block"})})},hide:function(){var a=this;this.content.transition({opacity:0},2e3,function(){a.content.attr({visibility:"hidden",display:"none"})})}}),$(function(){"use strict";new gb.ui.ContentManager("#content");$(window).resize(gb.util.throttle(gb.ui.onResizeHandler,500))});
//# sourceMappingURL=site.map.js